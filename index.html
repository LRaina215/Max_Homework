<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘å¿ƒä¸­çš„é©¬å…‹æ€ | 2024çº§æ™ºç§‘ä½œä¸š</title>
    
    <!-- å¼•å…¥æ ¸å¿ƒåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        :root {
            --primary-red: #ff2a2a;
            --gold: #ffd700;
            --bg-color: #050505;
            --glass: rgba(20, 20, 20, 0.9);
            --code-green: #00ff00;
        }

        body, html { margin: 0; padding: 0; overflow-x: hidden; background-color: var(--bg-color); color: #e0e0e0; font-family: 'Courier New', 'Segoe UI', sans-serif; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: var(--primary-red); border-radius: 4px; }

        /* === å¯åŠ¨é¡µ === */
        #start-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 1s ease; text-align: center;
        }
        .start-btn {
            padding: 15px 40px; border: 2px solid var(--primary-red); color: var(--primary-red);
            background: transparent; font-size: 1.2rem; font-weight: bold; cursor: pointer;
            text-transform: uppercase; letter-spacing: 3px; transition: 0.3s; margin-top: 30px;
            animation: pulse 2s infinite;
        }
        .start-btn:hover { background: var(--primary-red); color: #fff; box-shadow: 0 0 30px var(--primary-red); }
        .music-credit { margin-top: 20px; font-size: 0.9rem; color: var(--gold); font-style: italic; opacity: 0.8; }
        @keyframes pulse { 0% {box-shadow: 0 0 0 0 rgba(255, 42, 42, 0.4);} 70% {box-shadow: 0 0 0 20px rgba(255, 42, 42, 0);} 100% {box-shadow: 0 0 0 0 rgba(255, 42, 42, 0);} }

        /* === å¯¼èˆªæ  === */
        nav { position: fixed; top: 0; width: 100%; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; z-index: 1000; background: rgba(0,0,0,0.6); backdrop-filter: blur(8px); border-bottom: 1px solid rgba(255, 42, 42, 0.3); box-sizing: border-box; }
        .logo { font-weight: 900; font-size: 1.2rem; color: var(--primary-red); letter-spacing: 1px; }
        .fix-btn { background: rgba(255, 255, 255, 0.1); border: 1px solid #555; color: #aaa; padding: 5px 10px; font-size: 0.7rem; cursor: pointer; border-radius: 4px; transition: 0.3s; }
        .fix-btn:hover { border-color: var(--gold); color: var(--gold); }

        #canvas-container { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: -1; }

        .content { position: relative; z-index: 10; width: 100%; max-width: 1200px; margin: 0 auto; opacity: 0; transition: opacity 1s; }

        .section { min-height: 85vh; padding: 80px 20px; display: flex; flex-direction: column; justify-content: center; position: relative; }
        .hero { min-height: 100vh; justify-content: flex-end; padding-bottom: 100px; } /* è®©æ–‡å­—ç¨å¾®é ä¸‹ï¼Œç•™å‡ºä¸­é—´ç»™å¤´åƒ */
        
        h1 { font-size: clamp(3rem, 8vw, 6rem); margin: 0; line-height: 1; color: #fff; text-shadow: 0 0 20px rgba(255, 42, 42, 0.5); }
        h1 span { color: var(--primary-red); }
        .hero-desc { margin-top: 30px; font-size: 1.2rem; border-left: 4px solid var(--gold); padding-left: 15px; color: #fff; max-width: 700px; background: rgba(0,0,0,0.6); padding: 15px; border-radius: 0 10px 10px 0; }

        /* ç†è®ºå¡ç‰‡ */
        .theory-card { 
            background: var(--glass); border: 1px solid rgba(255, 42, 42, 0.3); 
            padding: 30px; border-radius: 8px; position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 20px;
        }
        .theory-card:hover { border-color: var(--gold); }
        .theory-card::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--primary-red); }
        .theory-card h2 { color: var(--gold); margin-top: 0; font-size: 1.8rem; }
        .highlight { color: var(--primary-red); font-weight: bold; background: rgba(255, 42, 42, 0.1); padding: 0 4px; }

        /* AI Chat */
        .chat-container { width: 100%; height: 500px; background: rgba(0, 0, 0, 0.85); border: 1px solid var(--primary-red); border-radius: 10px 10px 0 0; display: flex; flex-direction: column; box-shadow: 0 0 50px rgba(255, 42, 42, 0.15); overflow: hidden; }
        .chat-header { padding: 15px 20px; background: rgba(255, 42, 42, 0.15); border-bottom: 1px solid var(--primary-red); display: flex; justify-content: space-between; align-items: center; }
        .chat-window { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        .message { max-width: 85%; padding: 15px; border-radius: 8px; line-height: 1.6; font-size: 0.95rem; }
        .message.user { align-self: flex-end; background: #333; color: #fff; border: 1px solid #555; }
        .message.ai { align-self: flex-start; background: rgba(60, 0, 0, 0.6); border: 1px solid var(--primary-red); color: #ffd1d1; }
        .chat-input-area { padding: 20px; background: #111; display: flex; gap: 10px; border-top: 1px solid #333; }
        input[type="text"] { flex: 1; background: #222; border: 1px solid #444; color: #fff; padding: 15px; border-radius: 4px; }
        button { background: var(--primary-red); color: #fff; border: none; padding: 0 30px; cursor: pointer; font-weight: bold; border-radius: 4px; }

        /* Tech Panel */
        .tech-panel {
            background: #000; border: 1px dashed #555; border-top: none; padding: 15px;
            font-size: 0.8rem; color: #888; font-family: 'Consolas', monospace;
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; border-radius: 0 0 10px 10px;
        }
        .tech-item { display: flex; align-items: center; }
        .tech-label { color: var(--gold); margin-right: 10px; font-weight: bold; }
        .tech-value { color: var(--code-green); }
        @media (max-width: 600px) { .tech-panel { grid-template-columns: 1fr; } }

        /* åŸåˆ›å±•ç¤ºåŒº */
        .showcase-container { display: flex; gap: 30px; height: 600px; }
        .poster-box { flex: 1; background: #111; border: 2px solid #333; border-radius: 8px; overflow: hidden; position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.8); transition: 0.3s; }
        .poster-box img { width: 100%; height: 100%; object-fit: contain; background: #000; }
        .poster-label { position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.8); color: #fff; text-align: center; padding: 10px; font-size: 0.9rem; border-top: 1px solid var(--primary-red); }
        .lyrics-box { flex: 1; background: rgba(20, 20, 20, 0.6); border: 1px solid rgba(255, 42, 42, 0.3); border-radius: 8px; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; backdrop-filter: blur(10px); }
        .lyrics-title { color: var(--gold); font-size: 1.5rem; border-bottom: 2px solid var(--primary-red); padding-bottom: 15px; margin-bottom: 20px; }
        .lyrics-content { font-size: 0.95rem; line-height: 1.8; color: #ccc; white-space: pre-wrap; font-family: 'Segoe UI', sans-serif; }
        .section-tag { color: var(--primary-red); font-weight: bold; margin-top: 15px; display: block; }
        @media (max-width: 768px) { .showcase-container { flex-direction: column; height: auto; } .poster-box { height: 300px; } .lyrics-box { height: 400px; } }

        .music-control { position: fixed; bottom: 80px; right: 20px; z-index: 1001; cursor: pointer; opacity: 0.5; transition: 0.3s; }
        .music-control:hover { opacity: 1; transform: scale(1.1); }
        footer { background: rgba(0,0,0,0.9); border-top: 1px solid #333; padding: 40px 20px; text-align: center; color: #666; margin-top: 50px; }
        .team-names { color: var(--gold); font-weight: bold; margin-bottom: 10px; letter-spacing: 1px; }

    </style>
</head>
<body>

    <audio id="bgm" loop><source src="music.mp3" type="audio/mpeg"></audio>

    <div id="start-screen">
        <h1 style="font-size: 2.5rem; margin-bottom: 10px;">RED PROJECT</h1>
        <div class="team-names" style="font-size: 1rem; margin-bottom: 30px;">Created by æ ¾ä¿Šè¾‰ Â· æ—å­è½© Â· é©¬æ¬£å®‡</div>
        <button class="start-btn" onclick="startExperience()">è¿›å…¥æ€æƒ³çŸ©é˜µ / ENTER</button>
        <div class="music-credit">ğŸµ èƒŒæ™¯éŸ³ä¹ï¼šã€Šç ´æ™“çš„é’Ÿå£°ã€‹ (åŸåˆ› / Original Composition)</div>
        <p style="margin-top: 10px; color: #444; font-size: 0.7rem;">ä½©æˆ´è€³æœºä½“éªŒæœ€ä½³</p>
    </div>

    <div class="music-control" onclick="toggleMusic()" title="åˆ‡æ¢éŸ³ä¹">
        <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="#ff2a2a" stroke-width="2"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg>
    </div>

    <nav>
        <div class="logo">RED_PROJECT // 1818-202X</div>
        <button class="fix-btn" onclick="forceShowContent()">âš ï¸ å†…å®¹æ²¡æ˜¾ç¤ºï¼Ÿç‚¹æˆ‘ä¿®å¤</button>
    </nav>

    <!-- 3D ç²’å­å®¹å™¨ -->
    <div id="canvas-container"></div>

    <div class="content" id="main-content">
        
        <!-- Hero: ç²’å­å¤´åƒå±•ç¤ºåŒº -->
        <div class="section hero">
            <h1>CYBER <br><span>MARX</span></h1>
            <div class="hero-desc"><p id="typewriter"></p></div>
            <div style="margin-top: 50px; opacity: 0.6; font-size: 0.9rem;">â†“ ç§»åŠ¨é¼ æ ‡æ”¹å˜è§†è§’ | å‘ä¸‹æ»šåŠ¨</div>
        </div>

        <div class="section scroll-reveal">
            <div class="theory-card">
                <h2>01 / æ•°å­—å…¬æœ‰åˆ¶</h2>
                <h3>ä»ã€Šèµ„æœ¬è®ºã€‹åˆ° Open Source</h3>
                <p>åœ¨å·¥ä¸šæ—¶ä»£ï¼Œé©¬å…‹æ€æ‰¹åˆ¤äº†<span class="highlight">ç”Ÿäº§èµ„æ–™çš„ç§æœ‰åˆ¶</span>ã€‚è€Œåœ¨ä»Šå¤©çš„æ•°å­—ä¸–ç•Œï¼Œä»£ç æˆä¸ºäº†æ–°çš„ç”Ÿäº§èµ„æ–™ã€‚<br><br>**å¼€æºè½¯ä»¶è¿åŠ¨ (Open Source)** æ˜¯ä¸€åœºæœªç»å®£æ‰¬çš„å…±äº§ä¸»ä¹‰å®è·µã€‚GitHub ä¸Šçš„å¼€æºä»“åº“ï¼Œå®é™…ä¸Šæ„å»ºäº†ä¸€ä¸ª<span class="highlight">æ•°å­—å…¬æœ‰åœ° (Digital Commons)</span>ã€‚</p>
            </div>
        </div>

        <div class="section scroll-reveal">
            <div class="theory-card">
                <h2>02 / ç®—æ³•å¼‚åŒ–</h2>
                <h3>æ•°æ®æ‹œç‰©æ•™ (Data Fetishism)</h3>
                <p>åœ¨ç®—æ³•æ—¶ä»£ï¼Œå¼‚åŒ–æ›´åŠ éšè”½ã€‚æˆ‘ä»¬é€šè¿‡ç‚¹å‡»å’Œæµè§ˆåˆ›é€ äº†æ•°æ®ï¼ˆæ•°å­—åŠ³åŠ¨ï¼‰ï¼Œä½†è¿™äº›æ•°æ®åè¿‡æ¥å˜æˆäº†æ¨èç®—æ³•ï¼ˆæ•°å­—èµ„æœ¬ï¼‰æ¥æ§åˆ¶æˆ‘ä»¬çš„å–œå¥½ã€‚æˆ‘ä»¬ä¸å†æ˜¯æŠ€æœ¯çš„ä¸»äººï¼Œè€Œæ˜¯<span class="highlight">æµé‡çš„å¥´éš¶</span>ã€‚</p>
            </div>
        </div>

        <!-- AI Chat -->
        <div class="section scroll-reveal chat-section">
            <h2 style="margin-bottom: 30px; color: #fff; font-size: 2rem;"><span style="color:var(--primary-red)">//</span> è·¨æ—¶ç©ºè¿çº¿ï¼šAsk Marx</h2>
            <div class="chat-container">
                <div class="chat-header">
                    <div><span class="status-dot"></span><span style="font-weight: bold;">Karl_Marx_v1.0.exe</span></div>
                    <div style="font-size: 0.8rem; color: #aaa;">DeepSeek Powered</div>
                </div>
                <div class="chat-window" id="chat-window">
                    <div class="message ai"><strong>é©¬å…‹æ€:</strong> åŒå¿—ä½ å¥½ã€‚æˆ‘åœ¨å†å²çš„è¿·é›¾ä¸­è§‚å¯Ÿç€ä½ ä»¬çš„æ—¶ä»£ã€‚æœ‰ä½•å›°æƒ‘ï¼Ÿ</div>
                </div>
                <div class="chat-input-area">
                    <input type="text" id="user-input" placeholder="è¾“å…¥é—®é¢˜..." autocomplete="off">
                    <button onclick="sendMessage()">å‘é€</button>
                </div>
            </div>
            
            <div class="tech-panel">
                <div class="tech-item"><span class="tech-label">>> æ ¸å¿ƒæ¨¡å‹:</span><span class="tech-value">DeepSeek-V3 (671B MoE)</span></div>
                <div class="tech-item"><span class="tech-label">>> è§’è‰²å¾®è°ƒ:</span><span class="tech-value">Prompt Engineering (å”¯ç‰©å²è§‚åº“)</span></div>
                <div class="tech-item"><span class="tech-label">>> æ¸²æŸ“æŠ€æœ¯:</span><span class="tech-value">WebGL Particle Reconstruction</span></div>
                <div class="tech-item"><span class="tech-label">>> è·¨åŸŸæ–¹æ¡ˆ:</span><span class="tech-value">API Proxy Forwarding</span></div>
            </div>
        </div>

        <!-- åŸåˆ›æˆæœ -->
        <div class="section scroll-reveal" style="min-height: auto;">
            <h2 style="margin-bottom: 30px; color: #fff; font-size: 2rem; border-left: 5px solid var(--gold); padding-left: 20px;">
                <span style="color:var(--gold)">//</span> å›¢é˜ŸåŸåˆ›æˆæœå±•ç¤º
            </h2>
            <div class="showcase-container">
                <div class="poster-box">
                    <img src="poster.jpg" alt="å°ç»„æ‰‹æŠ„æŠ¥ - æˆ‘å¿ƒä¸­çš„é©¬å…‹æ€">
                    <div class="poster-label">ğŸ“· å›¢é˜Ÿæ‰‹ç»˜ä½œå“ï¼šã€Šæˆ‘å¿ƒä¸­çš„é©¬å…‹æ€ã€‹</div>
                </div>
                <div class="lyrics-box">
                    <div class="lyrics-title">ğŸµ åŸåˆ›æ­Œæ›²ï¼šã€Šç ´æ™“çš„é’Ÿå£°ã€‹</div>
                    <div class="lyrics-content">
<span class="section-tag">[Chorus]</span>
ä½ æ˜¯ æˆ‘å¿ƒä¸­ ç ´æ™“çš„é’Ÿå£° å”¤é†’äº† æ²‰ç¡ é‚£ä¸ªæ¢¦
ä½ è®© æˆ‘çœ‹æ‡‚ å¹³å‡¡çš„è‹±é›„ ä¹Ÿæ‹¥æœ‰ æ’¼åŠ¨ä¸–ç•Œ çš„å…‰è£
ç©¿è¶Šè¿‡ ç™¾å¹´æ—¶ç©ºçš„è£‚ç¼ ä½ ä¾ç„¶å¹´è½» ä¾ç„¶è®©æˆ‘ä»¬ æ„ŸåŠ¨
<span class="section-tag">[Bridge]</span>
è–ªç«åœ¨ä¼ é€’ ä»ä½ çš„æ‰‹é‡Œ äº¤åˆ°äº† æˆ‘ä»¬çš„æ‰‹é‡Œ...
(é¼“ç‚¹æ¸å¼ºæ»šå¥) ç”Ÿç”Ÿï¼ä¸æ¯ï¼
<span class="section-tag">[Outro]</span>
(é’¢ç´å›å½’å¹³é™) æˆ‘å¿ƒä¸­çš„... é‚£ä¸€æŠ¹çº¢...
(å®Œæ•´æ­Œè¯è§ä¸Šæ–‡)
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div class="team-names">Team: æ ¾ä¿Šè¾‰ / æ—å­è½© / é©¬æ¬£å®‡</div>
            <div class="course-info">Create For - é©¬å…‹æ€ä¸»ä¹‰åŸç†2024çº§æ™ºèƒ½ç§‘å­¦ä¸æŠ€æœ¯è¯¾ç¨‹ä½œä¸š</div>
            <div style="margin-top: 10px; font-size: 0.7rem;">Powered by WebGL & DeepSeek AI</div>
        </footer>

    </div>

    <script>
        function forceShowContent() {
            ScrollTrigger.getAll().forEach(t => t.kill());
            document.querySelectorAll('.content, .section, .scroll-reveal, .theory-card').forEach(el => {
                el.style.opacity = '1'; el.style.transform = 'none'; el.style.visibility = 'visible';
            });
            alert("å·²æ‰§è¡Œå¼ºåˆ¶ä¿®å¤ã€‚");
        }

        function startExperience() {
            const audio = document.getElementById('bgm');
            audio.volume = 0.5; audio.play().catch(e => console.log("éœ€äº¤äº’æ’­æ”¾"));
            document.getElementById('start-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('start-screen').style.display = 'none';
                document.getElementById('main-content').style.opacity = '1';
                ScrollTrigger.refresh(); typeWriter();
            }, 1000);
        }
        function toggleMusic() { const a=document.getElementById('bgm'); if(a.paused)a.play();else a.pause(); }

        // ============================================
        // ğŸ”¥ æ ¸å¿ƒå‡çº§ï¼šå…¨æ¯ç²’å­é©¬å…‹æ€ (Pixel Mapping)
        // ============================================
        const scene = new THREE.Scene(); 
        scene.fog = new THREE.FogExp2(0x050505, 0.02);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        camera.position.z = 100;

        // 1. åˆ›å»ºæ™®é€šèƒŒæ™¯ç²’å­ (æ˜Ÿç©º)
        const starGeo = new THREE.BufferGeometry();
        const starCount = 2000;
        const starPos = new Float32Array(starCount * 3);
        for(let i=0; i<starCount*3; i++) { starPos[i] = (Math.random()-0.5)*300; }
        starGeo.setAttribute('position', new THREE.BufferAttribute(starPos, 3));
        const starMat = new THREE.PointsMaterial({color: 0x444444, size: 0.5, transparent: true, opacity: 0.5});
        const starMesh = new THREE.Points(starGeo, starMat);
        scene.add(starMesh);

        // 2. åˆ›å»ºé©¬å…‹æ€ç²’å­å¤´åƒ
        let marxParticles;
        // âš ï¸ ç¡®ä¿ç›®å½•ä¸‹æœ‰ marx.png (é»‘ç™½æˆ–é€æ˜èƒŒæ™¯æœ€ä½³, å®½åº¦å»ºè®®200pxå·¦å³)
        const imageLoader = new THREE.ImageLoader();
        imageLoader.load('marx.png', (image) => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 200; // é™ä½åˆ†è¾¨ç‡ä»¥æå‡æ€§èƒ½
            canvas.height = 200 * (image.height / image.width);
            ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
            
            const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imgData.data;
            
            const geometry = new THREE.BufferGeometry();
            const positions = [];
            const colors = [];
            const color1 = new THREE.Color(0xff2a2a); // çº¢
            const color2 = new THREE.Color(0xffd700); // é‡‘

            for (let y = 0; y < canvas.height; y++) {
                for (let x = 0; x < canvas.width; x++) {
                    const i = (y * canvas.width + x) * 4;
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    const a = data[i + 3];

                    // åªæœ‰éé€æ˜ä¸”ç¨å¾®æœ‰ç‚¹äº®åº¦çš„åƒç´ æ‰ç”Ÿæˆç²’å­
                    if (a > 100 && (r+g+b)/3 > 30) {
                        // åæ ‡æ˜ å°„ï¼šå±…ä¸­
                        const pX = (x - canvas.width / 2) * 0.4;
                        const pY = -(y - canvas.height / 2) * 0.4; // ç¿»è½¬Yè½´
                        // ç®€å•çš„ 3D æµ®é›•æ•ˆæœï¼šè¶Šäº®è¶Šé å‰
                        const pZ = ((r+g+b)/3) * 0.05; 

                        positions.push(pX, pY, pZ);
                        
                        // éšæœºé¢œè‰²æ··åˆ
                        const mixedColor = color1.clone().lerp(color2, Math.random());
                        colors.push(mixedColor.r, mixedColor.g, mixedColor.b);
                    }
                }
            }

            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));

            const material = new THREE.PointsMaterial({
                size: 0.4,
                vertexColors: true,
                transparent: true,
                opacity: 0.9,
                blending: THREE.AdditiveBlending
            });

            marxParticles = new THREE.Points(geometry, material);
            scene.add(marxParticles);
            // åˆå§‹å¾®è°ƒä½ç½®
            marxParticles.position.y = 10; 
        });

        // é¼ æ ‡äº¤äº’
        let mouseX = 0, mouseY = 0;
        let targetRotX = 0, targetRotY = 0;
        
        document.addEventListener('mousemove', e => {
            mouseX = (e.clientX - window.innerWidth/2) * 0.001;
            mouseY = (e.clientY - window.innerHeight/2) * 0.001;
        });

        function animate() {
            requestAnimationFrame(animate);
            
            // èƒŒæ™¯æ˜Ÿç©ºæ…¢é€Ÿæ—‹è½¬
            starMesh.rotation.y += 0.0005;

            // é©¬å…‹æ€å¤´åƒè·Ÿéšé¼ æ ‡æ—‹è½¬
            if (marxParticles) {
                targetRotY = mouseX * 0.5; // å·¦å³çœ‹
                targetRotX = mouseY * 0.5; // ä¸Šä¸‹çœ‹
                
                // å¹³æ»‘æ’å€¼ (Lerp)
                marxParticles.rotation.y += 0.05 * (targetRotY - marxParticles.rotation.y);
                marxParticles.rotation.x += 0.05 * (targetRotX - marxParticles.rotation.x);
            }

            renderer.render(scene, camera);
        }
        animate();
        
        window.addEventListener('resize',()=>{camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);ScrollTrigger.refresh();});

        // GSAP
        gsap.registerPlugin(ScrollTrigger);
        window.addEventListener("load",()=>{ScrollTrigger.refresh();});
        gsap.utils.toArray('.scroll-reveal').forEach(elem=>{
            gsap.from(elem, { y: 50, opacity: 0, duration: 1, ease: "power2.out", scrollTrigger: { trigger: elem, start: "top 85%", toggleActions: "play none none reverse" } });
        });
        const text="å“²å­¦å®¶ä»¬åªæ˜¯ç”¨ä¸åŒçš„æ–¹å¼è§£é‡Šä¸–ç•Œï¼Œé—®é¢˜åœ¨äºæ”¹å˜ä¸–ç•Œã€‚";
        let tIdx=0; function typeWriter(){if(tIdx<text.length){document.getElementById("typewriter").innerHTML+=text.charAt(tIdx);tIdx++;setTimeout(typeWriter,50);}}

        // AI Chat
        const API_KEY=""; const API_URL="/api/chat";
        async function sendMessage(){
            const i=document.getElementById('user-input'); const t=i.value.trim(); if(!t)return;
            addMessage('user',t); i.value=''; const l=addMessage('ai','<span style="opacity:0.7">æ€è€ƒä¸­...</span>');
            try{
                const r=await fetch(API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"system",content:"ä½ ç°åœ¨æ˜¯å¡å°”Â·é©¬å…‹æ€..."},{role:"user",content:t}]})});
                if(!r.ok)throw new Error("API Error"); const d=await r.json(); updateMessage(l,d.choices[0].message.content);
            }catch(e){updateMessage(l,"å†å²çš„è¾©è¯æ³•å‘Šè¯‰æˆ‘ä»¬... (ç¦»çº¿æ¨¡å¼)");}
        }
        function addMessage(r,h){const w=document.getElementById('chat-window'),d=document.createElement('div');d.className=`message ${r}`;d.id='msg-'+Date.now();d.innerHTML=r==='ai'?`<strong>é©¬å…‹æ€:</strong> ${h}`:h;w.appendChild(d);w.scrollTop=w.scrollHeight;return d.id;}
        function updateMessage(id,t){document.getElementById(id).innerHTML=`<strong>é©¬å…‹æ€:</strong> ${window.marked?marked.parseInline(t):t}`;}
        document.getElementById('user-input').addEventListener('keypress',e=>{if(e.key==='Enter')sendMessage();});
    </script>
</body>
</html>